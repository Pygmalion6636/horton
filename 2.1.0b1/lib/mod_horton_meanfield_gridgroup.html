

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.7.5. horton.meanfield.gridgroup – Container for observables involving numerical integration &mdash; HORTON 2.1.0b1-1-ge018244 (Feb 03, 2017) documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="HORTON 2.1.0b1-1-ge018244 (Feb 03, 2017) documentation" href="../index.html"/>
        <link rel="up" title="3.7. horton.meanfield – Mean-field electronic structure code" href="pck_horton_meanfield.html"/>
        <link rel="next" title="3.7.6. horton.meanfield.guess – Initial guesses for wavefunctions" href="mod_horton_meanfield_guess.html"/>
        <link rel="prev" title="3.7.4. horton.meanfield.convergence – Evaluation of convergence criteria" href="mod_horton_meanfield_convergence.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/horton.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.1.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro_horton_overview.html">1. HORTON Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_citing_horton.html">2. Citing HORTON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_license_information.html">3. License Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_contact_information.html">4. Contact Information</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_download_and_install.html">1. Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_getting_started.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_hamiltonian.html">3. Hamiltonians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_estruct.html">4. Electronic Structure Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_postproc.html">5. Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_other.html">6. Other Topics</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical stuff</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tech_dev.html">1. Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tech_ref.html">2. Reference Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tech_api.html">3. API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pck_horton.html">3.1. <code class="docutils literal"><span class="pre">horton</span></code> &#8211; The main HORTON Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_espfit.html">3.2. <code class="docutils literal"><span class="pre">horton.espfit</span></code> &#8211; Electrostatic potential fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_gbasis.html">3.3. <code class="docutils literal"><span class="pre">horton.gbasis</span></code> &#8211; Gaussian basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_grid.html">3.4. <code class="docutils literal"><span class="pre">horton.grid</span></code> &#8211; Numerical integration grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_io.html">3.5. <code class="docutils literal"><span class="pre">horton.io</span></code> &#8211; Input and output routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_matrix.html">3.6. <code class="docutils literal"><span class="pre">horton.matrix</span></code> &#8211; One-, two-, three- and four-dimensional matrix implementations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pck_horton_meanfield.html">3.7. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_bond_order.html">3.7.1. <code class="docutils literal"><span class="pre">horton.meanfield.bond_order</span></code> &#8211; Generic implementation of bond orders for mean-field wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_builtin.html">3.7.2. <code class="docutils literal"><span class="pre">horton.meanfield.builtin</span></code> &#8211; Built-in energy terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_cext.html">3.7.3. <code class="docutils literal"><span class="pre">horton.meanfield.cext</span></code> &#8211; C++ extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_convergence.html">3.7.4. <code class="docutils literal"><span class="pre">horton.meanfield.convergence</span></code> &#8211; Evaluation of convergence criteria</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.7.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_guess.html">3.7.6. <code class="docutils literal"><span class="pre">horton.meanfield.guess</span></code> &#8211; Initial guesses for wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_hamiltonian.html">3.7.7. <code class="docutils literal"><span class="pre">horton.meanfield.hamiltonian</span></code> &#8211; Mean-field DFT/HF Hamiltonian data structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_libxc.html">3.7.8. <code class="docutils literal"><span class="pre">horton.meanfield.libxc</span></code> &#8211; Interface to LDA, GGA and hybrid functionals from LibXC</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_observable.html">3.7.9. <code class="docutils literal"><span class="pre">horton.meanfield.observable</span></code> &#8211; Base classes for energy terms and other observables of the wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_occ.html">3.7.10. <code class="docutils literal"><span class="pre">horton.meanfield.occ</span></code> &#8211; Occupation number models</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_project.html">3.7.11. <code class="docutils literal"><span class="pre">horton.meanfield.project</span></code> &#8211; Projection of 1-electron orbitals to a new basis set</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_response.html">3.7.12. <code class="docutils literal"><span class="pre">horton.meanfield.response</span></code> &#8211; Evaluation of response functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_rotate.html">3.7.13. <code class="docutils literal"><span class="pre">horton.meanfield.rotate</span></code> &#8211; Rotation of orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf.html">3.7.14. <code class="docutils literal"><span class="pre">horton.meanfield.scf</span></code> &#8211; Basic Self-Consistent Field (SCF) algorithm.</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_cdiis.html">3.7.15. <code class="docutils literal"><span class="pre">horton.meanfield.scf_cdiis</span></code> &#8211; Commutator DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_diis.html">3.7.16. <code class="docutils literal"><span class="pre">horton.meanfield.scf_diis</span></code> &#8211; Abstract DIIS code used by the different DIIS implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_ediis.html">3.7.17. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis</span></code> &#8211; Energy DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_ediis2.html">3.7.18. <code class="docutils literal"><span class="pre">horton.meanfield.scf_ediis2</span></code> &#8211; EDIIS+DIIS SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_scf_oda.html">3.7.19. <code class="docutils literal"><span class="pre">horton.meanfield.scf_oda</span></code> &#8211; Optimal Damping SCF algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="mod_horton_meanfield_utils.html">3.7.20. <code class="docutils literal"><span class="pre">horton.meanfield.utils</span></code> &#8211; Utility functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_modelhamiltonians.html">3.8. <code class="docutils literal"><span class="pre">horton.modelhamiltonians</span></code> &#8211; Model Hamiltonians</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_part.html">3.9. <code class="docutils literal"><span class="pre">horton.part</span></code> &#8211; Density-based partitioning (fuzzy atoms-in-molecules) package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pck_horton_scripts.html">3.10. <code class="docutils literal"><span class="pre">horton.scripts</span></code> &#8211; Code (solely) used by HORTON&#8217;s command line scripts</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">HORTON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tech_api.html">3. API Documentation</a> &raquo;</li>
      
          <li><a href="pck_horton_meanfield.html">3.7. <code class="docutils literal"><span class="pre">horton.meanfield</span></code> &#8211; Mean-field electronic structure code</a> &raquo;</li>
      
    <li>3.7.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/lib/mod_horton_meanfield_gridgroup.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-horton.meanfield.gridgroup">
<span id="horton-meanfield-gridgroup-container-for-observables-involving-numerical-integration"></span><h1>3.7.5. <code class="docutils literal"><span class="pre">horton.meanfield.gridgroup</span></code> &#8211; Container for observables involving numerical integration<a class="headerlink" href="#module-horton.meanfield.gridgroup" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="horton.meanfield.gridgroup.GridGroup">
<em class="property">class </em><code class="descclassname">horton.meanfield.gridgroup.</code><code class="descname">GridGroup</code><span class="sig-paren">(</span><em>obasis</em>, <em>grid</em>, <em>grid_terms</em>, <em>label='grid_group'</em>, <em>density_cutoff=1e-09</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mod_horton_meanfield_observable.html#horton.meanfield.observable.Observable" title="horton.meanfield.observable.Observable"><code class="xref py py-class docutils literal"><span class="pre">horton.meanfield.observable.Observable</span></code></a></p>
<p>Initialize a GridGroup instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obasis</strong> (<a class="reference internal" href="mod_horton_gbasis_cext.html#horton.gbasis.cext.GOBasis" title="horton.gbasis.cext.GOBasis"><em>GOBasis</em></a>) &#8211; The orbital basis.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid. (must have <code class="docutils literal"><span class="pre">points</span></code> attribute and
<code class="docutils literal"><span class="pre">integrate</span></code> method.)</li>
<li><strong>grid_terms</strong> (<em>list of GridObservable instances.</em>) &#8211; The contributions to the effective Hamiltonian.</li>
<li><strong>label</strong> (<em>str</em>) &#8211; A label for the group.</li>
<li><strong>density_cutoff</strong> (<em>float</em>) &#8211; Whenever the density on a grid point falls below this threshold, all data for
that grid point is set to zero. This is mainly relevant for functionals that
use derivatives of the density or the orbitals, i.e. GGA and MGGA functionals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="horton.meanfield.gridgroup.GridGroup.add_dot_hessian">
<code class="descname">add_dot_hessian</code><span class="sig-paren">(</span><em>cache</em>, <em>*outputs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridGroup.add_dot_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contribution to the dot product of the Hessian with the trial delta DM.</p>
<p>The Hessian in this method is the second derivative of the observable towards the
matrix elements of the density matrix or matrices. The <code class="docutils literal"><span class="pre">dms</span></code> and <code class="docutils literal"><span class="pre">delta</span> <span class="pre">dms</span></code>
are stored in the cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> &#8211; A cache object used to store intermediate results that can be reused or
inspected later. All results specific for the detla_dm are stored with the tag
&#8216;d&#8217; in the cache object.</li>
<li><strong>output2, ...</strong> (<em>output1,</em>) &#8211; Output objects, to which contributions from the dot product of the Hessian
with the delta density matrices is added.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.GridGroup.add_fock">
<code class="descname">add_fock</code><span class="sig-paren">(</span><em>cache</em>, <em>*focks</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridGroup.add_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contributions to the Fock matrix.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</li>
<li><strong>focks</strong> (<em>list of TwoIndex</em>) &#8211; A list of Fock matrices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.GridGroup.compute_energy">
<code class="descname">compute_energy</code><span class="sig-paren">(</span><em>cache</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridGroup.compute_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sum of the expectation values.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="horton.meanfield.gridgroup.GridGroup.df_level">
<code class="descname">df_level</code><a class="headerlink" href="#horton.meanfield.gridgroup.GridGroup.df_level" title="Permalink to this definition">¶</a></dt>
<dd><p>The density-functional level of this grid group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>df_level</strong> &#8211; This can be any of the following:<ul class="simple">
<li><code class="docutils literal"><span class="pre">DF_LEVEL_LDA</span></code>: only LDA functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_GGA</span></code>: GGA (and LDA) functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_MGGA</span></code>: MGGA (and LDA and/or GGA) functionals are used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.meanfield.gridgroup.RGridGroup">
<em class="property">class </em><code class="descclassname">horton.meanfield.gridgroup.</code><code class="descname">RGridGroup</code><span class="sig-paren">(</span><em>obasis</em>, <em>grid</em>, <em>grid_terms</em>, <em>label='grid_group'</em>, <em>density_cutoff=1e-09</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.RGridGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#horton.meanfield.gridgroup.GridGroup" title="horton.meanfield.gridgroup.GridGroup"><code class="xref py py-class docutils literal"><span class="pre">horton.meanfield.gridgroup.GridGroup</span></code></a></p>
<p>Initialize a GridGroup instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obasis</strong> (<a class="reference internal" href="mod_horton_gbasis_cext.html#horton.gbasis.cext.GOBasis" title="horton.gbasis.cext.GOBasis"><em>GOBasis</em></a>) &#8211; The orbital basis.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid. (must have <code class="docutils literal"><span class="pre">points</span></code> attribute and
<code class="docutils literal"><span class="pre">integrate</span></code> method.)</li>
<li><strong>grid_terms</strong> (<em>list of GridObservable instances.</em>) &#8211; The contributions to the effective Hamiltonian.</li>
<li><strong>label</strong> (<em>str</em>) &#8211; A label for the group.</li>
<li><strong>density_cutoff</strong> (<em>float</em>) &#8211; Whenever the density on a grid point falls below this threshold, all data for
that grid point is set to zero. This is mainly relevant for functionals that
use derivatives of the density or the orbitals, i.e. GGA and MGGA functionals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="horton.meanfield.gridgroup.RGridGroup.add_dot_hessian">
<code class="descname">add_dot_hessian</code><span class="sig-paren">(</span><em>cache</em>, <em>output_alpha</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.RGridGroup.add_dot_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contribution to the dot product of the Hessian with the trial delta DM.</p>
<p>The Hessian in this method is the second derivative of the observable towards the
matrix elements of the density matrix or matrices. The <code class="docutils literal"><span class="pre">dms</span></code> and <code class="docutils literal"><span class="pre">delta</span> <span class="pre">dms</span></code>
are stored in the cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> &#8211; A cache object used to store intermediate results that can be reused or
inspected later. All results specific for the detla_dm are stored with the tag
&#8216;d&#8217; in the cache object.</li>
<li><strong>output2, ...</strong> (<em>output1,</em>) &#8211; Output objects, to which contributions from the dot product of the Hessian
with the delta density matrices is added.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.RGridGroup.add_fock">
<code class="descname">add_fock</code><span class="sig-paren">(</span><em>cache</em>, <em>*focks</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.RGridGroup.add_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contributions to the Fock matrix.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</li>
<li><strong>focks</strong> (<em>list of TwoIndex</em>) &#8211; A list of Fock matrices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.RGridGroup.compute_energy">
<code class="descname">compute_energy</code><span class="sig-paren">(</span><em>cache</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.RGridGroup.compute_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sum of the expectation values.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="horton.meanfield.gridgroup.RGridGroup.df_level">
<code class="descname">df_level</code><a class="headerlink" href="#horton.meanfield.gridgroup.RGridGroup.df_level" title="Permalink to this definition">¶</a></dt>
<dd><p>The density-functional level of this grid group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>df_level</strong> &#8211; This can be any of the following:<ul class="simple">
<li><code class="docutils literal"><span class="pre">DF_LEVEL_LDA</span></code>: only LDA functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_GGA</span></code>: GGA (and LDA) functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_MGGA</span></code>: MGGA (and LDA and/or GGA) functionals are used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.meanfield.gridgroup.UGridGroup">
<em class="property">class </em><code class="descclassname">horton.meanfield.gridgroup.</code><code class="descname">UGridGroup</code><span class="sig-paren">(</span><em>obasis</em>, <em>grid</em>, <em>grid_terms</em>, <em>label='grid_group'</em>, <em>density_cutoff=1e-09</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.UGridGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#horton.meanfield.gridgroup.GridGroup" title="horton.meanfield.gridgroup.GridGroup"><code class="xref py py-class docutils literal"><span class="pre">horton.meanfield.gridgroup.GridGroup</span></code></a></p>
<p>Initialize a GridGroup instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obasis</strong> (<a class="reference internal" href="mod_horton_gbasis_cext.html#horton.gbasis.cext.GOBasis" title="horton.gbasis.cext.GOBasis"><em>GOBasis</em></a>) &#8211; The orbital basis.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid. (must have <code class="docutils literal"><span class="pre">points</span></code> attribute and
<code class="docutils literal"><span class="pre">integrate</span></code> method.)</li>
<li><strong>grid_terms</strong> (<em>list of GridObservable instances.</em>) &#8211; The contributions to the effective Hamiltonian.</li>
<li><strong>label</strong> (<em>str</em>) &#8211; A label for the group.</li>
<li><strong>density_cutoff</strong> (<em>float</em>) &#8211; Whenever the density on a grid point falls below this threshold, all data for
that grid point is set to zero. This is mainly relevant for functionals that
use derivatives of the density or the orbitals, i.e. GGA and MGGA functionals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="horton.meanfield.gridgroup.UGridGroup.add_dot_hessian">
<code class="descname">add_dot_hessian</code><span class="sig-paren">(</span><em>cache</em>, <em>*outputs</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.UGridGroup.add_dot_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contribution to the dot product of the Hessian with the trial delta DM.</p>
<p>The Hessian in this method is the second derivative of the observable towards the
matrix elements of the density matrix or matrices. The <code class="docutils literal"><span class="pre">dms</span></code> and <code class="docutils literal"><span class="pre">delta</span> <span class="pre">dms</span></code>
are stored in the cache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> &#8211; A cache object used to store intermediate results that can be reused or
inspected later. All results specific for the detla_dm are stored with the tag
&#8216;d&#8217; in the cache object.</li>
<li><strong>output2, ...</strong> (<em>output1,</em>) &#8211; Output objects, to which contributions from the dot product of the Hessian
with the delta density matrices is added.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.UGridGroup.add_fock">
<code class="descname">add_fock</code><span class="sig-paren">(</span><em>cache</em>, <em>*focks</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.UGridGroup.add_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Add contributions to the Fock matrix.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</li>
<li><strong>focks</strong> (<em>list of TwoIndex</em>) &#8211; A list of Fock matrices.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.UGridGroup.compute_energy">
<code class="descname">compute_energy</code><span class="sig-paren">(</span><em>cache</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.UGridGroup.compute_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sum of the expectation values.</p>
<p>This method basically dispatches the work to all <code class="docutils literal"><span class="pre">GridObservable</span></code> instances in
<code class="docutils literal"><span class="pre">self.grid_terms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to store intermediate results.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="horton.meanfield.gridgroup.UGridGroup.df_level">
<code class="descname">df_level</code><a class="headerlink" href="#horton.meanfield.gridgroup.UGridGroup.df_level" title="Permalink to this definition">¶</a></dt>
<dd><p>The density-functional level of this grid group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>df_level</strong> &#8211; This can be any of the following:<ul class="simple">
<li><code class="docutils literal"><span class="pre">DF_LEVEL_LDA</span></code>: only LDA functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_GGA</span></code>: GGA (and LDA) functionals are used.</li>
<li><code class="docutils literal"><span class="pre">DF_LEVEL_MGGA</span></code>: MGGA (and LDA and/or GGA) functionals are used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.meanfield.gridgroup.GridObservable">
<em class="property">class </em><code class="descclassname">horton.meanfield.gridgroup.</code><code class="descname">GridObservable</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridObservable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Initialize a GridObservable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>label</strong> (<em>str</em>) &#8211; A unique label for this contribution.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="horton.meanfield.gridgroup.GridObservable.add_dot">
<code class="descname">add_dot</code><span class="sig-paren">(</span><em>cache</em>, <em>grid</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridObservable.add_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dot product with the kernel to the output arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to share intermediate results between the <code class="docutils literal"><span class="pre">compute</span></code> and <code class="docutils literal"><span class="pre">add_pot</span></code>
methods. This cache will also contain pre-computed functions evaluate on the
grid. See <a class="reference internal" href="#horton.meanfield.gridgroup.RGridGroup" title="horton.meanfield.gridgroup.RGridGroup"><code class="xref py py-class docutils literal"><span class="pre">RGridGroup</span></code></a> and <a class="reference internal" href="#horton.meanfield.gridgroup.UGridGroup" title="horton.meanfield.gridgroup.UGridGroup"><code class="xref py py-class docutils literal"><span class="pre">UGridGroup</span></code></a> for more details.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid.</li>
<li><strong>args</strong> (<em>list of [np.ndarray, shape=(npoint, npot), dtype=float]</em>) &#8211; The result of this method is added to these output arguments. They are a list
of <cite>dot</cite> arrays. (Only one array for the alpha density in case of restricted.
Two arrays, one for alpha and one for beta electrons, in case of
unrestricted.) To each array <cite>dot</cite> data will be added, e.g. the dot product of
the density kernel with a change in density, the dot product of the gradient
kernel with a change in gradient, etc.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.GridObservable.add_pot">
<code class="descname">add_pot</code><span class="sig-paren">(</span><em>cache</em>, <em>grid</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridObservable.add_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the potential to the output arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to share intermediate results between the <code class="docutils literal"><span class="pre">compute</span></code> and <code class="docutils literal"><span class="pre">add_pot</span></code>
methods. This cache will also contain pre-computed functions evaluate on the
grid. See <a class="reference internal" href="#horton.meanfield.gridgroup.RGridGroup" title="horton.meanfield.gridgroup.RGridGroup"><code class="xref py py-class docutils literal"><span class="pre">RGridGroup</span></code></a> and <a class="reference internal" href="#horton.meanfield.gridgroup.UGridGroup" title="horton.meanfield.gridgroup.UGridGroup"><code class="xref py py-class docutils literal"><span class="pre">UGridGroup</span></code></a> for more details.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid.</li>
<li><strong>args</strong> (<em>list of [np.ndarray, shape=(npoint, npot), dtype=float]</em>) &#8211; <p>A list of potential arrays. (Only one array for the alpha density in case of
restricted. Two arrays, one for alpha and one for beta electrons, in case of
unrestricted.) Each array contains <cite>potential</cite> data, e.g. derivatives of a
density functional toward:</p>
<ul>
<li>column 0: the density</li>
<li>columns 1,2,3: gradient (x, y, z)</li>
<li>column 4: Laplacian</li>
<li>column 5: kinetic energy density</li>
</ul>
<p>Later columns may not be present if the functional does not need them. They
could be present when other terms in the effective Hamiltonian need them.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="horton.meanfield.gridgroup.GridObservable.compute_energy">
<code class="descname">compute_energy</code><span class="sig-paren">(</span><em>cache</em>, <em>grid</em><span class="sig-paren">)</span><a class="headerlink" href="#horton.meanfield.gridgroup.GridObservable.compute_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the expectation value using numerical integration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache</strong> (<a class="reference internal" href="mod_horton_cache.html#horton.cache.Cache" title="horton.cache.Cache"><em>Cache</em></a>) &#8211; Used to share intermediate results between the <code class="docutils literal"><span class="pre">compute</span></code> and <code class="docutils literal"><span class="pre">add_pot</span></code>
methods. This cache will also contain pre-computed functions evaluate on the
grid. See <a class="reference internal" href="#horton.meanfield.gridgroup.RGridGroup" title="horton.meanfield.gridgroup.RGridGroup"><code class="xref py py-class docutils literal"><span class="pre">RGridGroup</span></code></a> and <a class="reference internal" href="#horton.meanfield.gridgroup.UGridGroup" title="horton.meanfield.gridgroup.UGridGroup"><code class="xref py py-class docutils literal"><span class="pre">UGridGroup</span></code></a> for more details.</li>
<li><strong>grid</strong> (<a class="reference internal" href="mod_horton_grid_base.html#horton.grid.base.IntGrid" title="horton.grid.base.IntGrid"><em>IntGrid</em></a>) &#8211; A numerical integration grid.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="horton.meanfield.gridgroup.GridObservable.df_level">
<code class="descname">df_level</code><em class="property"> = None</em><a class="headerlink" href="#horton.meanfield.gridgroup.GridObservable.df_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mod_horton_meanfield_guess.html" class="btn btn-neutral float-right" title="3.7.6. horton.meanfield.guess – Initial guesses for wavefunctions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mod_horton_meanfield_convergence.html" class="btn btn-neutral" title="3.7.4. horton.meanfield.convergence – Evaluation of convergence criteria" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>Documentation for HORTON 2.1.0b1 built from release 2.1.0b1-1-ge018244 (Feb 03, 2017). </div>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2015, The HORTON Development Team.
      Last updated on Feb 03, 2017.
    </p>
  </div>

  <div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.1.0b1-1-ge018244 (Feb 03, 2017)',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>